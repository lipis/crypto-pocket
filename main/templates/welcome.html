# extends 'base.html'
# import 'macro/utils.html' as utils

# block header
  # if current_user.id == 0
    <div class="jumbotron">
      <div class="container text-center">
        <h1>{{config.CONFIG_DB.brand_name}}</h1>
        <p>{{_('Monitor your crypto investments')}}</p>
      </div>
    </div>
  # endif
# endblock

# block content
  # if current_user.id > 0
    <p class="text-center">
      <a class="btn btn-primary" href="{{url_for('transaction_update')}}">
        <fa class="fa fa-plus fa-fw"></fa> Add Transaction
      </a>
    </p>
    <div class="table-responsive {{'hide' if not transaction_dbs|count}}">
      <table class="table table-bordered table-hover">
        <thead>
          <tr class="text-nowrap">
            <th class="text-center"></th>
            <th class="text-center">{{utils.order_by_link('profit_percentage', '%')}}</th>
            <th class="col-xs-2 text-center">{{utils.order_by_link('acquired_amount', _('Acquired'))}}</th>
            <th class="col-xs-2 text-center">{{utils.order_by_link('profit_amount', _('Profit'))}}</th>
            <th class="col-xs-2 text-center">{{utils.order_by_link('total', _('Total'))}}</th>
            <th class="col-xs-2 text-center">{{utils.order_by_link('spent_amount', _('Spent'))}}</th>
            <th class="col-xs-1 text-center">{{_('Current Rate')}}<br><small>{{_('Acquired Rate')}}</small></th>
            <th class="col-xs-2 text-center">{{utils.order_by_link('date', _('Date'))}}</th>
          </tr>
        </thead>
        <tbody>
          # for transaction_db in transaction_dbs
            <tr class="row-link text-nowrap {{'text-success' if transaction_db.total > transaction_db.spent_amount else 'text-danger' if transaction_db.current_rate else 'text-muted'}}" id="{{transaction_db.key.urlsafe()}}" data-href="{{url_for('transaction_view', transaction_id=transaction_db.key.id())}}">
              # set spent_currency = transaction_db.spent_currency_key.get().code
              # set acquired_currency = transaction_db.acquired_currency_key.get().code
              <td class="text-center">{{utils.currency_icon(acquired_currency)}}</td>
              <td class="text-right">
                {{'%.1f%%' % transaction_db.profit_percentage}}
                # if transaction_db.profit_percentage > 0
                  <span class="fa fa-fw fa-arrow-up"></span>
                # elif transaction_db.profit_percentage < 0
                  <span class="fa fa-fw fa-arrow-down"></span>
                # else
                  <span class="fa fa-fw fa-minus"></span>
                # endif
              </td>
              <td class="text-right">{{utils.currency(transaction_db.acquired, transaction_db.acquired_currency_key.get().code)}}</td>
              <td class="text-right">{{utils.currency(transaction_db.profit_amount, spent_currency)}}</td>
              <td class="text-right">{{utils.currency(transaction_db.total, spent_currency)}}</td>
              <td class="text-right">
                <div>{{utils.currency(transaction_db.spent, spent_currency)}}</div>
                # if transaction_db.fee
                  <small class="text-muted">{{utils.currency(transaction_db.fee, spent_currency)}}</small>
                # endif
              </td>
              <td class="text-right">
                <div>{{utils.currency(transaction_db.current_rate, spent_currency)}}</div>
                <small class="text-muted">{{utils.currency(transaction_db.acquired_rate, spent_currency)}}</small>
              </td>
              <td class="text-center">{{transaction_db.date.strftime('%d %b %Y')}}</td>
            </tr>
          # endfor
        </tbody>
      </table>
    </div>

    {{utils.next_link(next_url)}}
  # endif
# endblock
